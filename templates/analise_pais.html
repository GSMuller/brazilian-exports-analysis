<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise por País - Dashboard de Exportações</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <nav class="navbar navbar-dark bg-dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Análise de Exportações por País</span>
            <div>
                <a href="/" class="btn btn-outline-light btn-sm me-2">Visão Geral</a>
                <a href="/analise-pais" class="btn btn-light btn-sm me-2">Análise por País</a>
                <a href="/series-temporais" class="btn btn-outline-light btn-sm">Séries Temporais</a>
            </div>
        </div>
    </nav>

    <div class="container-fluid mt-4">
        <!-- Filtros -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Filtros</h5>
                        <div class="row">
                            <div class="col-md-2">
                                <label for="year-select" class="form-label">Ano</label>
                                <select id="year-select" class="form-select">
                                    <option value="2024" selected>2024</option>
                                    <option value="2023">2023</option>
                                    <option value="2022">2022</option>
                                    <option value="2021">2021</option>
                                    <option value="2020">2020</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="month-select" class="form-label">Mês</label>
                                <select id="month-select" class="form-select">
                                    <option value="01">Janeiro</option>
                                    <option value="02">Fevereiro</option>
                                    <option value="03">Março</option>
                                    <option value="04">Abril</option>
                                    <option value="05">Maio</option>
                                    <option value="06">Junho</option>
                                    <option value="07">Julho</option>
                                    <option value="08">Agosto</option>
                                    <option value="09">Setembro</option>
                                    <option value="10">Outubro</option>
                                    <option value="11">Novembro</option>
                                    <option value="12" selected>Dezembro</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="pais-select" class="form-label">País</label>
                                <select id="pais-select" class="form-select">
                                    <option value="">Carregando...</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label for="produto-filter" class="form-label">Filtrar Produto (opcional)</label>
                                <select id="produto-filter" class="form-select">
                                    <option value="">Todos os produtos</option>
                                </select>
                                <small class="text-muted">Deixe em "Todos" para ver todos</small>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button id="apply-filters" class="btn btn-primary w-100">Aplicar</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- KPIs -->
        <div class="row mb-4" id="kpis-section">
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Valor Total Exportado</h6>
                        <h3 class="card-title" id="kpi-total-fob">-</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Peso Total (kg)</h6>
                        <h3 class="card-title" id="kpi-total-peso">-</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Produtos Exportados</h6>
                        <h3 class="card-title" id="kpi-produtos">-</h3>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card text-center">
                    <div class="card-body">
                        <h6 class="card-subtitle mb-2 text-muted">Preço Médio (USD/kg)</h6>
                        <h3 class="card-title" id="kpi-preco-medio">-</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráficos -->
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="alert alert-info">
                            <strong>Gráfico de Dispersão:</strong> Cada bolha representa um produto. 
                            O tamanho da bolha indica o valor exportado (USD), 
                            a posição horizontal o peso (kg), 
                            e a vertical o preço médio (USD/kg). 
                            Produtos no topo são de alto valor agregado.
                        </div>
                        <div id="bubble-chart" style="height: 500px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="row mb-4">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div id="bar-chart" style="height: 400px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
            </div>
        </div>
    </div>

    <footer class="mt-5 py-3 bg-light">
        <div class="container text-center">
            <small class="text-muted">
                Dados obtidos de ComexStat - Ministério da Economia
            </small>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/analise_pais.js') }}"></script>
</body>
</html>
